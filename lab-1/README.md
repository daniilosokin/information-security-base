# Основы информационной безопасности. Лабораторная работа №1

## Теоретические сведения

### Частотный побитовый тест

Если проверяемая последовательность достаточно случайна, то величина ее
P-значения достаточно близка к единице. Этот тест оценивает эту близость.

Пусть дана последовательность $ε$ длиной $N$ и пусть «1» – это 1, 
а «0» – это -1. Тогда:

$$
S_{n} = \frac{1}{\sqrt{N}} \sum_{i=1}^{n} x_{i} \text{ , где } x_{i} =
\begin{cases} 
1 \text{ , если элемент проверяемой последовательности равен 1 }
\\ 
-1 \text{ , если элемент проверяемой последовательности равен 0 }
\end{cases}
$$

С помощью дополнительной функции ошибок вычисляем P-значение:

$$
P_{value}=erfc(\frac{S_{N}}{\sqrt{2}})
$$

где $erfc(x)$ – это дополнительная функция ошибок (присутствует в стандартной
библиотеке `math.h` языка С и `cmath` языка С++).

### Тест на одинаковые подряд идущие биты

Тест заключается в поиске всех последовательностей одинаковых битов. Потом
количество и размеры этих последовательностей анализируют на соответствие
истинно случайной эталонной последовательности. Основная задача этого
теста – установить насколько часто происходит смена «1» на «0» и обратно.

Сначала вычисляем долю единиц в последовательности $ε$ длинной $N$:

$$
ζ=\frac{1}{N}\sum_{i=1}^{N} ε_{i} \text{ , где } ε_{i} \text{ – это элементы проверяемой последовательности.}
$$

Далее проверяется условие $ζ-\frac{1}{2}<\frac{2}{\sqrt{N}}$. Если оно истинно,
то тест продолжается, иначе – P-значение считается равным нулю.

Далее вычисляется число знакоперемен $V_{N}$ и на его основе P-значение:

$$
V_{n} = \sum{i=1}{N-1} r_{i} \text{ , где } r_{i} =
\begin{cases} 
0 \text{ , если } {ε_{i}}={ε_{i+1}}
\\ 
1 \text{ , если } {ε_{i}}\neq{ε_{i+1}}
\end{cases}
$$

$$
P_{value}=erfc(\frac{|V_{N} - 2 N ζ (1−ζ)|}{2 \sqrt{2N} ζ (1−ζ)}
$$

### Тест на самую длинную последовательность единиц в блоке

Исходная последовательность $ε$ длинной $N$ разбивается на блоки длиной $M$. 
Внутри блока ищется самая длинная последовательность из единиц, происходит
ее оценка, которая сравнивается с аналогичной оценкой для эталонной случайной
последовательности. Для последовательности в $N=128$ бит длина блока $M$ равна 8.

Далее в каждом блоке ищется максимальная длина подпоследовательности подряд
идущих единиц (так в блоке, например «01001100» максимальная длина подряд идущих
единиц равна 2, а в блоке «00010101» равна 1).

Далее считается статистика по разным длинам $v_{i}$ следующим способом (для $M=8$):

$$
\begin{matrix}
v_{1} = \begin{Bmatrix} \text{кол-во блоков с макс. длиной} ≤ 1 \end{Bmatrix}
\\                                                
v_{2} = \begin{Bmatrix} \text{кол-во блоков с макс. длиной} = 2 \end{Bmatrix}
\\                                                
v_{3} = \begin{Bmatrix} \text{кол-во блоков с макс. длиной} = 3 \end{Bmatrix}
\\                                                
v_{4} = \begin{Bmatrix} \text{кол-во блоков с макс. длиной} ≥ 4 \end{Bmatrix}
\end{matrix}
$$

Например, для последовательности «11001100 00010101 01101100 01001100 11100000
00000010 01001101 01010001 00010011 11010110 10000000 11010111 11001100 11100110
11011000 10110010» (для удобства сразу разделена на блоки) эти значения vi будут
следующие:

$$
\begin{matrix}
v_{1} = \begin{Bmatrix} \text{кол-во блоков с макс. длиной} ≤ 1 \end{Bmatrix} = 4
\\         
v_{2} = \begin{Bmatrix} \text{кол-во блоков с макс. длиной} = 2 \end{Bmatrix}= 9
\\         
v_{3} = \begin{Bmatrix} \text{кол-во блоков с макс. длиной} = 3 \end{Bmatrix} = 3
\\         
v_{4} = \begin{Bmatrix} \text{кол-во блоков с макс. длиной} ≥ 4 \end{Bmatrix} = 0
\end{matrix}
$$

Затем вычисляется Хи-квадрат (для данной лабораторной работы для
последовательности длиной в 128 бит с блоками длиной 8):

$$
χ^2=\sum_{i=o}^{3}\frac{(v_{i} - 16 π_{i})^2}{16 π_{i}}
$$

Распределение Хи-квадрат – это распределение суммы квадратов $k$ независимых
случайных величин; критерий хи-квадрат – это любая статистическая проверка гипотезы,
в которой выборочное распределение критерия имеет распределение хи-квадрат.

Теоретические вероятности $π_{i}$ задаются константами:

$$
\begin{matrix}
π_{0}=0.2148
\\
π_{1}=0.3672
\\
π_{2}=0.2305
\\
π_{3}=0.1875
\end{matrix}
$$

Далее вычисляется P-значение:

$$
P_{value}=igamc(\frac{3}{2} , \frac{χ^{2}}{2})
$$

где $igamc(x,y)$ – это неполная гамма-функция.

Для всех тестов справедливо, что если P-значение ≥ 0.01, то последовательность
признается случайной.


## Задание

Необходимо сгенерировать псевдослучайные последовательности с
помощью стандартных ГПСЧ языков С/С++ и Java (в случае отсутствия среды Java-
разработки разрешено использовать любой онлайн Java-машину.

Длина последовательностей – 128 бит, последовательности – бинарные.

Далее необходимо написать программу на любом удобном языке
программирования, реализующую представленные здесь три теста линейки NIST и
проверить с их помощью сгенерированные последовательности (ввиду сложности
реализации неполной гамма-функции из третьего теста студентам предлагается
воспользоваться онлайн калькулятором неполной гамма-функции.

Сделать вывод по полученным результатам.
